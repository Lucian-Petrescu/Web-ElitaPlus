<?xml version="1.0" encoding="utf-8" ?>

<!-- ********************** THIS FILE HAS BEEN GENERATED FROM TEMPLATE SQLObject.cst (7/20/2004)********************** -->

<SQL>
  <LOAD>
    <![CDATA[	
			SELECT 
				dealer_id,
				contract_type_id,
				effective,
				expiration,
				commissions_percent,
				marketing_percent,
				admin_expense,
				profit_percent,
				loss_cost_percent,
				currency_id,
				type_of_marketing_id,
				type_of_equipment_id,
				type_of_insurance_id,
				min_replacement_cost,
				warranty_max_delay,
				net_commissions_id,
				net_marketing_id,
				net_taxes_id,
				deductible,
				waiting_period,
				funding_source_id,
				policy,
				recurring_premium_id,
				edit_model_id,
				dealer_markup_id,
				fixed_esc_duration_flag,
				auto_mfg_coverage_id,
				restrict_markup_id,
				layout,
				suspense_days,
				cancellation_days,
				created_date,
				modified_date,
				created_by,
				modified_by,
				comment1,
				contract_id,
				replacement_policy_id,
				participation_percent,
				coinsurance_id,
				rating_plan,
				id_validation_id,
				claim_control_id,
				currency_conversion_id,
				currency_of_coverages_id,
				remaining_mfg_days,
				acsel_prod_code_id,
	      auto_set_liability_id,
        cancellation_reason_id,
        deductible_percent,
				coverage_deductible_id,
        full_refund_days,
        Ignore_Incoming_Premium_ID,
				repair_discount_pct,
				replacement_discount_pct,
				ignore_coverage_amt_id,
        backend_claims_allowed_id,
        edit_mfg_term_id,
        acct_business_unit_id,
        installment_payment_id,
        days_of_first_pymt, 
        days_to_send_letter, 
        days_to_cancel_cert,
        deduct_by_mfg_id,
        penalty_pct,
        clip_percent,
        is_comm_p_code_id,         
        base_installments,
        max_installments,
        billing_cycle_frequency,
        installments_base_reducer,
        past_due_months_allowed,
        collection_re_attempts,
        include_first_pmt, 
        collection_cycle_type_id, 
        cycle_day, 
        offset_before_due_date,
        ins_premium_factor,
        extend_coverage_id,
				extra_mons_to_extend_coverage,
				extra_days_to_extend_coverage,
        ALLOW_DIFFERENT_COVERAGE,
		    ALLOW_NO_EXTENDED,
				num_of_claims,
				claim_limit_based_on_id,
				days_to_report_claim,
        marketing_promo_id,
        cust_address_required_id,
        first_pymt_months,
        deductible_based_on_id, 
        pro_rata_method_id,
        ALLOW_MULTIPLE_REJECTIONS_ID,  
        pay_outstanding_premium_id,        
        authorized_amount_max_updates,
        allow_pymt_skip_months,
		    recurring_warranty_period,
        NUMBER_OF_DAYS_TO_REACTIVATE,
				billing_cycle_type_id,
				daily_rate_based_on_id,
        allow_billing_after_cncltn,
        allow_collctn_after_cncltn,
        replacement_policy_claim_count,
        future_date_allow_for_id,
        ignore_waiting_period_wsd_psd,
        allow_coverage_markup_dtbn,
        num_of_repair_claims,
        num_of_replacement_claims,
        deductible_expression_id,
        payment_processing_type_id,
				third_party_name,
				third_party_tax_id,
				rdo_name,
				rdo_tax_id,
				rdo_percent,
        override_edit_mfg_term_xcd,
        policy_type_id,
				policy_generation_id,
				line_of_business_id,
        producer_id,
        commissions_percent_source_xcd,
        marketing_percent_source_xcd,
        admin_expense_source_xcd,
        profit_percent_source_xcd,
        loss_cost_percent_source_xcd 
			FROM elp_contract 
			WHERE
				contract_id = :contract_id
		]]>
      </LOAD>
      <LOAD_LIST>
        SELECT
        c.contract_id,
        c.dealer_id,
        c.effective,
        c.expiration,
        d.DEALER dealer_code,
        d.dealer,
        d.dealer_name,
        c.layout,
        comp.code company_code
        FROM
        elp_contract c,
        elp_dealer d,
        elp_company comp
        WHERE
        c.dealer_id = d.dealer_id
        AND d.dealer_id like :dealer_id
        AND d.company_id = comp.company_id
        --dynamic_in_clause
        --dynamic_order_by_clause
      </LOAD_LIST>
      <UPDATE>
        <![CDATA[	
			UPDATE elp_contract SET
				dealer_id = :dealer_id,
				contract_type_id = :contract_type_id,
				effective = :effective,
				expiration = :expiration,
				commissions_percent = :commissions_percent,
				marketing_percent = :marketing_percent,
				admin_expense = :admin_expense,
				profit_percent = :profit_percent,
				loss_cost_percent = :loss_cost_percent,
				currency_id = :currency_id,				
				type_of_marketing_id = :type_of_marketing_id,
				type_of_equipment_id = :type_of_equipment_id,
				type_of_insurance_id = :type_of_insurance_id,
				min_replacement_cost = :min_replacement_cost,
				warranty_max_delay = :warranty_max_delay,
				net_commissions_id = :net_commissions_id,
				net_marketing_id = :net_marketing_id,
				net_taxes_id = :net_taxes_id,
				deductible = :deductible,
				waiting_period = :waiting_period,
				funding_source_id = :funding_source_id,
				policy = :policy,
				recurring_premium_id = :recurring_premium_id,
				edit_model_id = :edit_model_id,
				dealer_markup_id = :dealer_markup_id,
				fixed_esc_duration_flag = :fixed_esc_duration_flag,
				auto_mfg_coverage_id = :auto_mfg_coverage_id,
				restrict_markup_id = :restrict_markup_id,
				layout = :layout,
				suspense_days = :suspense_days,
				cancellation_days = :cancellation_days,
				comment1 = :comment1,
				modified_by = :modified_by,
				replacement_policy_id = :replacement_policy_id,
				participation_percent = :participation_percent,
				coinsurance_id = :coinsurance_id,
				rating_plan = :rating_plan,
				id_validation_id = :id_validation_id,
				claim_control_id = :claim_control_id,
				currency_conversion_id = :currency_conversion_id,
				currency_of_coverages_id = :currency_of_coverages_id,
				remaining_mfg_days = :remaining_mfg_days,
				acsel_prod_code_id = :acsel_prod_code_id,
        auto_set_liability_id = :auto_set_liability_id,
        cancellation_reason_id = :cancellation_reason_id,
        full_refund_days = :full_refund_days,       
        deductible_percent = :deductible_percent,
				coverage_deductible_id = :coverage_deductible_id,
        ignore_incoming_premium_id = :ignore_incoming_premium_id,
				repair_discount_pct = :repair_discount_pct,
				replacement_discount_pct = :replacement_discount_pct,
				ignore_coverage_amt_id  = :ignore_coverage_amt_id,          
        backend_claims_allowed_id = :backend_claims_allowed_id,
        edit_mfg_term_id = :edit_mfg_term_id,
        acct_business_unit_id = :acct_business_unit_id,
        installment_payment_id = :installment_payment_id,
        days_of_first_pymt = :days_of_first_pymt, 
        days_to_send_letter = :days_to_send_letter, 
        days_to_cancel_cert = :days_to_cancel_cert,
        deduct_by_mfg_id = :deduct_by_mfg_id,
        penalty_pct = :penalty_pct,
        clip_percent = :clip_percent,
        is_comm_p_code_id = :is_comm_p_code_id,        
        base_installments = :base_installments,
        max_installments = :max_installments,
        billing_cycle_frequency = :billing_cycle_frequency,
        installments_base_reducer = :installments_base_reducer,
        past_due_months_allowed = :past_due_months_allowed,
        collection_re_attempts = :collection_re_attempts,
        include_first_pmt = :include_first_pmt, 
        collection_cycle_type_id = :collection_cycle_type_id, 
        cycle_day = :cycle_day, 
        offset_before_due_date = :offset_before_due_date,
        ins_premium_factor = :ins_premium_factor,
        extend_coverage_id = :extend_coverage_id,
				extra_mons_to_extend_coverage = :extra_mons_to_extend_coverage,
				extra_days_to_extend_coverage = :extra_days_to_extend_coverage,
        ALLOW_DIFFERENT_COVERAGE = :ALLOW_DIFFERENT_COVERAGE,
		    ALLOW_NO_EXTENDED = :ALLOW_NO_EXTENDED,
				num_of_claims = :num_of_claims,
				claim_limit_based_on_id = :claim_limit_based_on_id,
				days_to_report_claim = :days_to_report_claim,
        marketing_promo_id = :marketing_promo_id,
        cust_address_required_id = :cust_address_required_id,
        first_pymt_months = :first_pymt_months,
        deductible_based_on_id = :deductible_based_on_id,
        pro_rata_method_id = :pro_rata_method_id,
        ALLOW_MULTIPLE_REJECTIONS_ID = :ALLOW_MULTIPLE_REJECTIONS_ID,    
        pay_outstanding_premium_id =:pay_outstanding_premium_id,        
        authorized_amount_max_updates = :authorized_amount_max_updates,
        allow_pymt_skip_months = :allow_pymt_skip_months,
		    recurring_warranty_period = :recurring_warranty_period,
        NUMBER_OF_DAYS_TO_REACTIVATE= :number_of_days_to_reactivate,
				billing_cycle_type_id = :billing_cycle_type_id,
				daily_rate_based_on_id = :daily_rate_based_on_id,
        allow_billing_after_cncltn = :allow_billing_after_cncltn,
        allow_collctn_after_cncltn = :allow_collctn_after_cncltn,
        replacement_policy_claim_count = :replacement_policy_claim_count,
        future_date_allow_for_id = :future_date_allow_for_id,
        ignore_waiting_period_wsd_psd = :ignore_waiting_period_wsd_psd,
        allow_coverage_markup_dtbn = :allow_coverage_markup_dtbn,
        num_of_repair_claims = :num_of_repair_claims,
        num_of_replacement_claims = :num_of_replacement_claims,
        deductible_expression_id = :deductible_expression_id, 
        payment_processing_type_id = :payment_processing_type_id,
				third_party_name = :third_party_name,
				third_party_tax_id = :third_party_tax_id,
				rdo_name = :rdo_name,
				rdo_tax_id = :rdo_tax_id,
				rdo_percent = :rdo_percent,
        override_edit_mfg_term_xcd = :override_edit_mfg_term_xcd,
        policy_type_id = :policy_type_id,
				policy_generation_id = :policy_generation_id,
				line_of_business_id = :line_of_business_id,
        producer_id = :producer_id,
        commissions_percent_source_xcd = :commissions_percent_source_xcd,
        marketing_percent_source_xcd = :marketing_percent_source_xcd,
        admin_expense_source_xcd = :admin_expense_source_xcd,
        profit_percent_source_xcd = :profit_percent_source_xcd,
        loss_cost_percent_source_xcd = :loss_cost_percent_source_xcd 
 		  WHERE
				contract_id = :contract_id
			AND NVL(modified_date,created_date) = NVL(:modified_date,created_date)
		]]>
      </UPDATE>
      <INSERT>
        INSERT INTO elp_contract
        (
        dealer_id,
        contract_type_id,
        effective,
        expiration,
        commissions_percent,
        marketing_percent,
        admin_expense,
        profit_percent,
        loss_cost_percent,
        currency_id,
        type_of_marketing_id,
        type_of_equipment_id,
        type_of_insurance_id,
        min_replacement_cost,
        warranty_max_delay,
        net_commissions_id,
        net_marketing_id,
        net_taxes_id,
        deductible,
        waiting_period,
        funding_source_id,
        policy,
        recurring_premium_id,
        edit_model_id,
        dealer_markup_id,
        fixed_esc_duration_flag,
        auto_mfg_coverage_id,
        restrict_markup_id,
        layout,
        suspense_days,
        cancellation_days,
        comment1,
        created_by,
        contract_id,
        replacement_policy_id,
        participation_percent,
        coinsurance_id,
        rating_plan,
        id_validation_id,
        claim_control_id,
        currency_conversion_id,
        currency_of_coverages_id,
        remaining_mfg_days,
        acsel_prod_code_id,
        auto_set_liability_id,
        cancellation_reason_id,
        deductible_percent,
        coverage_deductible_id,
        full_refund_days,
        ignore_incoming_premium_id,
        repair_discount_pct,
        replacement_discount_pct,
        ignore_coverage_amt_id,
        backend_claims_allowed_id,
        edit_mfg_term_id,
        acct_business_unit_id,
        installment_payment_id,
        days_of_first_pymt,
        days_to_send_letter,
        days_to_cancel_cert,
        deduct_by_mfg_id,
        penalty_pct,
        clip_percent,
        is_comm_p_code_id,
        base_installments,
        max_installments,
        billing_cycle_frequency,
        installments_base_reducer,
        past_due_months_allowed,
        collection_re_attempts,
        include_first_pmt,
        collection_cycle_type_id,
        cycle_day,
        offset_before_due_date,
        ins_premium_factor,
        extend_coverage_id,
        extra_mons_to_extend_coverage,
        extra_days_to_extend_coverage,
        ALLOW_DIFFERENT_COVERAGE,
        ALLOW_NO_EXTENDED,
        num_of_claims,
        claim_limit_based_on_id,
        days_to_report_claim,
        marketing_promo_id,
        cust_address_required_id,
        first_pymt_months,
        deductible_based_on_id,
        pro_rata_method_id,
        ALLOW_MULTIPLE_REJECTIONS_ID,
        pay_outstanding_premium_id,
        authorized_amount_max_updates,
        allow_pymt_skip_months,
        recurring_warranty_period,
        NUMBER_OF_DAYS_TO_REACTIVATE,
        billing_cycle_type_id,
        daily_rate_based_on_id,
        allow_billing_after_cncltn,
        allow_collctn_after_cncltn,
        replacement_policy_claim_count,
        future_date_allow_for_id,
        ignore_waiting_period_wsd_psd,
        allow_coverage_markup_dtbn,
        num_of_repair_claims,
        num_of_replacement_claims,
        deductible_expression_id,
        payment_processing_type_id,
        third_party_name,
        third_party_tax_id,
        rdo_name,
        rdo_tax_id,
        rdo_percent,
        override_edit_mfg_term_xcd,
        policy_type_id,
        policy_generation_id,
        line_of_business_id,
        producer_id,
        commissions_percent_source_xcd,
        marketing_percent_source_xcd,
        admin_expense_source_xcd,
        profit_percent_source_xcd,
        loss_cost_percent_source_xcd
        )
        VALUES
        (
        :dealer_id,
        :contract_type_id,
        :effective,
        :expiration,
        :commissions_percent,
        :marketing_percent,
        :admin_expense,
        :profit_percent,
        :loss_cost_percent,
        :currency_id,
        :type_of_marketing_id,
        :type_of_equipment_id,
        :type_of_insurance_id,
        :min_replacement_cost,
        :warranty_max_delay,
        :net_commissions_id,
        :net_marketing_id,
        :net_taxes_id,
        :deductible,
        :waiting_period,
        :funding_source_id,
        :policy,
        :recurring_premium_id,
        :edit_model_id,
        :dealer_markup_id,
        :fixed_esc_duration_flag,
        :auto_mfg_coverage_id,
        :restrict_markup_id,
        :layout,
        :suspense_days,
        :cancellation_days,
        :comment1,
        :created_by,
        :contract_id,
        :replacement_policy_id,
        :participation_percent,
        :coinsurance_id,
        :rating_plan,
        :id_validation_id,
        :claim_control_id,
        :currency_conversion_id,
        :currency_of_coverages_id,
        :remaining_mfg_days,
        :acsel_prod_code_id,
        :auto_set_liability_id,
        :cancellation_reason_id,
        :deductible_percent,
        :coverage_deductible_id,
        :full_refund_days,
        :ignore_incoming_premium_id,
        :repair_discount_pct,
        :replacement_discount_pct,
        :ignore_coverage_amt_id,
        :backend_claims_allowed_id,
        :edit_mfg_term_id,
        :acct_business_unit_id,
        :installment_payment_id,
        :days_of_first_pymt,
        :days_to_send_letter,
        :days_to_cancel_cert,
        :deduct_by_mfg_id,
        :penalty_pct,
        :clip_percent,
        :is_comm_p_code_id,
        :base_installments,
        :max_installments,
        :billing_cycle_frequency,
        :installments_base_reducer,
        :past_due_months_allowed,
        :collection_re_attempts,
        :include_first_pmt,
        :collection_cycle_type_id,
        :cycle_day,
        :offset_before_due_date,
        :ins_premium_factor,
        :extend_coverage_id,
        :extra_mons_to_extend_coverage,
        :extra_days_to_extend_coverage,
        :ALLOW_DIFFERENT_COVERAGE,
        :ALLOW_NO_EXTENDED,
        :num_of_claims,
        :claim_limit_based_on_id,
        :days_to_report_claim,
        :marketing_promo_id,
        :cust_address_required_id,
        :first_pymt_months,
        :deductible_based_on_id,
        :pro_rata_method_id,
        :ALLOW_MULTIPLE_REJECTIONS_ID,
        --:IGNORE_COVERAGE_RATE_ID,
        :pay_outstanding_premium_id,
        :authorized_amount_max_updates,
        :allow_pymt_skip_months,
        :recurring_warranty_period,
        :NUMBER_OF_DAYS_TO_REACTIVATE,
        :billing_cycle_type_id,
        :daily_rate_based_on_id,
        :allow_billing_after_cncltn,
        :allow_collctn_after_cncltn,
        :replacement_policy_claim_count,
        :future_date_allow_for_id,
        :ignore_waiting_period_wsd_psd,
        :allow_coverage_markup_dtbn,
        :num_of_repair_claims,
        :num_of_replacement_claims,
        :deductible_expression_id,
        :payment_processing_type_id,
        :third_party_name,
        :third_party_tax_id,
        :rdo_name,
        :rdo_tax_id,
        :rdo_percent,
        :override_edit_mfg_term_xcd,
        :policy_type_id,
        :policy_generation_id,
        :line_of_business_id,
        :producer_id,
        :commissions_percent_source_xcd,
        :marketing_percent_source_xcd,
        :admin_expense_source_xcd,
        :profit_percent_source_xcd,
        :loss_cost_percent_source_xcd
        )
      </INSERT>
  <DELETE>
    DELETE FROM elp_contract
    WHERE
    contract_id = :contract_id
  </DELETE>
  <LOAD_MIN_EFFECTIVE_MAX_EXPIRATION>
    SELECT
    MIN(effective) min_efective, MAX(expiration) max_expiration
    FROM
    elita.elp_contract
    WHERE
    dealer_id = :dealer_id
  </LOAD_MIN_EFFECTIVE_MAX_EXPIRATION>

  <LOAD_MAX_EXPIRATION_CONTRACT>
    SELECT * from
    (	SELECT
    contract_id,
    effective,
    expiration
    FROM
    elp_contract
    WHERE
    dealer_id =  :dealer_id
    ORDER BY expiration DESC )
    where rownum = 1
  </LOAD_MAX_EXPIRATION_CONTRACT>
  <GET_SERTIFICATES_COUNT>
    <![CDATA[	
	    select 	count(*) Cert_Count
			    from 	elp_contract cont,
						elp_dealer dealer,
				        elp_cert cert
				where	cont.dealer_id = dealer.dealer_id
				  and	cert.dealer_id = dealer.dealer_id
			      and	(cert.WARRANTY_SALES_DATE between cont.effective and cont.expiration)
			      and    cont.contract_id = :contract_id
			      and rownum = 1 
			]]>
  </GET_SERTIFICATES_COUNT>
  <GET_CONTRACT_BY_CERT_ID>
    SELECT
    c.contract_id
    FROM
    elp_contract c,
    elp_dealer d,
    elp_company comp,
    elp_cert cert
    WHERE
    c.dealer_id = d.dealer_id
    AND d.dealer_id = cert.dealer_id
    AND cert.cert_id = :cert_id
    AND (cert.WARRANTY_SALES_DATE between c.effective and c.expiration)
    AND d.company_id = comp.company_id
    --dynamic_in_clause
    --dynamic_order_by_clause
  </GET_CONTRACT_BY_CERT_ID>

  <GET_AUTO_GEN_SEQ_NUM>
    elp_utl_sequence.GetNextSequence
  </GET_AUTO_GEN_SEQ_NUM>

  <RETURN_UN_USED_AUTO_GEN_SEQ_NUM>
    elp_utl_sequence.RestoreUnusedSequence
  </RETURN_UN_USED_AUTO_GEN_SEQ_NUM>

</SQL>

