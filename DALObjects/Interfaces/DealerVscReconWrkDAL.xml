<?xml version="1.0" encoding="utf-8" ?>

<!-- ********************** THIS FILE HAS BEEN GENERATED FROM TEMPLATE SQLObject.cst (9/13/2011)********************** -->

<SQL>
  <LOAD>
    <![CDATA[	
			SELECT 
				dealerfile_processed_id,
				enrollment_id,
				reject_code,
				reject_msg_parms,
				reject_reason,
				certificate_loaded,
				dealer_id,
				user_id,
				record_type,
				company_code,
				certificate_number,
				customers,
				address1,
				city,
				region,
				postal_code,
				country_code,
				home_phone,
				model_year,
				model,
				manufacturer,
				engine_version,
				vehicle_license_tag,
				odometer,
				vin,
				purchase_price,
				purchase_date,
				in_service_date,
				delivery_date,
				plan_code,
				deductible,
				term_months,
				term_km_mi,
				agent_number,
				warranty_sale_date,
				plan_amount,
				document_type,
				identity_doc_no,
				rg_no,
				id_type,
				document_issue_date,
				document_agency,
				quote_number,
				quote_item_number,
				new_used,
				optional_coverage,
				birth_date,
				work_phone,
				payment_type_code,
				payment_instrument_code,
				installments_number,
				credit_card_type_code,
				name_on_credit_card,
				credit_card_number,
				expiration_date,
				bank_id,
				account_number,
				name_on_account,
				layout,
				created_by,
				created_date,
				modified_by,
				modified_date,
				branch_code,
				dealer_vsc_recon_wrk_id,
        external_car_code,
        PLAN_AMOUNT_WITH_MARKUP,
        PAYMENT_DATE,
        CANCELLATION_DATE,
        CANCELLATION_REASON_CODE,
        CANCEL_COMMENT_TYPE_CODE,
        CANCELLATION_COMMENT,
        financing_agency,
        nc_payment_method_code,
        account_type_code,
        tax_id,
        branch_digit,
        account_digit,
        refund_amount

			FROM elp_dealer_vsc_recon_wrk 
			WHERE
				dealer_vsc_recon_wrk_id = :dealer_vsc_recon_wrk_id
		]]>
  </LOAD>
  <LOAD_LIST>
    SELECT
    DRW.DEALER_VSC_RECON_WRK_ID,
    DRW.record_type,
    DRW.reject_code,
    DRW.reject_reason,
    DRW.company_code,
    (Select dealer from Elp_Dealer where dealer_id = DRW.Dealer_Id) as dealer_code,
    DRW.branch_code,
    DRW.certificate_number,
    DRW.customers,
    DRW.address1,
    DRW.city,
    DRW.region,
    DRW.postal_code,
    DRW.country_code,
    DRW.home_phone,
    DRW.model_year,
    DRW.manufacturer,
    DRW.model,
    DRW.engine_version,
    DRW.vehicle_license_tag,
    DRW.odometer,
    DRW.vin,
    DRW.purchase_price,
    DRW.purchase_date,
    DRW.in_service_date,
    DRW.delivery_date,
    DRW.plan_code,
    DRW.deductible,
    DRW.term_months,
    DRW.term_km_mi,
    DRW.agent_number,
    DRW.warranty_sale_date,
    DRW.plan_amount,
    DRW.document_type,
    DRW.identity_doc_no,
    DRW.rg_no,
    DRW.id_type,
    DRW.document_issue_date,
    DRW.document_agency,
    DRW.new_used,
    DRW.optional_coverage,
    DRW.birth_date,
    DRW.work_phone,
    DRW.payment_type_code,
    DRW.payment_instrument_code,
    DRW.installments_number,
    DRW.layout,
    DRW.created_by,
    DRW.created_date,
    DRW.modified_by,
    DRW.modified_date,
    DRW.external_car_code,
    DRW.PLAN_AMOUNT_WITH_MARKUP,
    DRW.PAYMENT_DATE,
    DRW.CANCELLATION_DATE,
    DRW.CANCELLATION_REASON_CODE,
    DRW.CANCEL_COMMENT_TYPE_CODE,
    DRW.CANCELLATION_COMMENT,
    mc.MSG_PARAMETER_COUNT,
    DRW.REJECT_MSG_PARMS,
    (SELECT TRANSLATION FROM ELP_LABEL innerL
    Inner join elp_dict_item_translation innert on innert.DICT_ITEM_ID = innerl.DICT_ITEM_ID
    and innert.LANGUAGE_ID = :language_id
    WHERE innerL.ui_prog_code = l.ui_prog_code
    ) Translated_MSG,
    DRW.financing_agency,
    DRW.nc_payment_method_code,
    DRW.account_type_code,
    DRW.tax_id,
    DRW.branch_digit,
    DRW.account_digit,
    DRW.refund_amount,
    DRW.name_on_account,
    DRW.bank_id
    FROM elp_dealer_vsc_recon_wrk DRW
    left outer join (select MSG_CODE, LABEL_ID, MSG_PARAMETER_COUNT
    From elp_message_code
    inner join ELP_LIST_ITEM li  ON msg_type = li.LIST_ITEM_ID AND li.code = 'DLREJECT'
    INNER JOIN ELP_LIST l ON l.LIST_ID = li.LIST_ID AND  l.code = 'MSGTYPE'
    ) mc on mc.MSG_CODE = DRW.reject_code
    left outer join elp_label l on l.label_id = mc.label_id
    WHERE dealerfile_processed_id = :dealerfile_processed_id
    AND reject_reason IS NOT NULL
  </LOAD_LIST>
  <LOAD_REJECT_LIST>
    SELECT
    Certificate_Number,
    Customers,
    record_type,
    VIN,
    reject_reason
    FROM elp_dealer_vsc_recon_wrk DRW
    WHERE
    dealerfile_processed_id = :dealerfile_processed_id
    AND reject_reason IS NOT NULL
  </LOAD_REJECT_LIST>
  <UPDATE>
    <![CDATA[	
			UPDATE elp_dealer_vsc_recon_wrk SET
				dealerfile_processed_id = :dealerfile_processed_id,
				enrollment_id = :enrollment_id,
				reject_code = :reject_code,
				reject_msg_parms = :reject_msg_parms,
				reject_reason = :reject_reason,
				certificate_loaded = :certificate_loaded,
				dealer_id = :dealer_id,
				user_id = :user_id,
				record_type = :record_type,
				company_code = :company_code,
				certificate_number = :certificate_number,
				customers = :customers,
				address1 = :address1,
				city = :city,
				region = :region,
				postal_code = :postal_code,
				country_code = :country_code,
				home_phone = :home_phone,
				model_year = :model_year,
				model = :model,
				manufacturer = :manufacturer,
				engine_version = :engine_version,
				vehicle_license_tag = :vehicle_license_tag,
				odometer = :odometer,
				vin = :vin,
				purchase_price = :purchase_price,
				purchase_date = :purchase_date,
				in_service_date = :in_service_date,
				delivery_date = :delivery_date,
				plan_code = :plan_code,
				deductible = :deductible,
				term_months = :term_months,
				term_km_mi = :term_km_mi,
				agent_number = :agent_number,
				warranty_sale_date = :warranty_sale_date,
				plan_amount = :plan_amount,
				document_type = :document_type,
				identity_doc_no = :identity_doc_no,
				rg_no = :rg_no,
				id_type = :id_type,
				document_issue_date = :document_issue_date,
				document_agency = :document_agency,
				quote_number = :quote_number,
				quote_item_number = :quote_item_number,
				new_used = :new_used,
				optional_coverage = :optional_coverage,
				birth_date = :birth_date,
				work_phone = :work_phone,
				payment_type_code = :payment_type_code,
				payment_instrument_code = :payment_instrument_code,
				installments_number = :installments_number,
				credit_card_type_code = :credit_card_type_code,
				name_on_credit_card = :name_on_credit_card,
				credit_card_number = :credit_card_number,
				expiration_date = :expiration_date,
				bank_id = :bank_id,
				account_number = :account_number,
				name_on_account = :name_on_account,
				layout = :layout,
				branch_code = :branch_code,
				modified_by = :modified_by,
        external_car_code = :external_car_code,
        PLAN_AMOUNT_WITH_MARKUP = :PLAN_AMOUNT_WITH_MARKUP,
        PAYMENT_DATE = :PAYMENT_DATE,
        CANCELLATION_DATE =:CANCELLATION_DATE,
        CANCELLATION_REASON_CODE = :CANCELLATION_REASON_CODE,
        CANCEL_COMMENT_TYPE_CODE = :CANCEL_COMMENT_TYPE_CODE,
        CANCELLATION_COMMENT = :CANCELLATION_COMMENT,
        financing_agency = :financing_agency,
        nc_payment_method_code = :nc_payment_method_code,
        account_type_code = :account_type_code,
        tax_id = :tax_id,
        branch_digit = :branch_digit,
        account_digit = :account_digit,
        refund_amount = :refund_amount

			WHERE
				dealer_vsc_recon_wrk_id = :dealer_vsc_recon_wrk_id
		]]>
  </UPDATE>
  <INSERT>
    INSERT INTO elp_dealer_vsc_recon_wrk
    (
    dealerfile_processed_id,
    enrollment_id,
    reject_code,
    reject_msg_parms,
    reject_reason,
    certificate_loaded,
    dealer_id,
    user_id,
    record_type,
    company_code,
    certificate_number,
    customers,
    address1,
    city,
    region,
    postal_code,
    country_code,
    home_phone,
    model_year,
    model,
    manufacturer,
    engine_version,
    vehicle_license_tag,
    odometer,
    vin,
    purchase_price,
    purchase_date,
    in_service_date,
    delivery_date,
    plan_code,
    deductible,
    term_months,
    term_km_mi,
    agent_number,
    warranty_sale_date,
    plan_amount,
    document_type,
    identity_doc_no,
    rg_no,
    id_type,
    document_issue_date,
    document_agency,
    quote_number,
    quote_item_number,
    new_used,
    optional_coverage,
    birth_date,
    work_phone,
    payment_type_code,
    payment_instrument_code,
    installments_number,
    credit_card_type_code,
    name_on_credit_card,
    credit_card_number,
    expiration_date,
    bank_id,
    account_number,
    name_on_account,
    layout,
    branch_code,
    created_by,
    dealer_vsc_recon_wrk_id,
    external_car_code,
    PLAN_AMOUNT_WITH_MARKUP,
    PAYMENT_DATE,
    CANCELLATION_DATE,
    CANCELLATION_REASON_CODE,
    CANCEL_COMMENT_TYPE_CODE,
    CANCELLATION_COMMENT,
    financing_agency,
    nc_payment_method_code,
    account_type_code,
    tax_id,
    branch_digit,
    account_digit,
    refund_amount

    )
    VALUES
    (
    :dealerfile_processed_id,
    :enrollment_id,
    :reject_code,
    :reject_msg_parms,
    :reject_reason,
    :certificate_loaded,
    :dealer_id,
    :user_id,
    :record_type,
    :company_code,
    :certificate_number,
    :customers,
    :address1,
    :city,
    :region,
    :postal_code,
    :country_code,
    :home_phone,
    :model_year,
    :model,
    :manufacturer,
    :engine_version,
    :vehicle_license_tag,
    :odometer,
    :vin,
    :purchase_price,
    :purchase_date,
    :in_service_date,
    :delivery_date,
    :plan_code,
    :deductible,
    :term_months,
    :term_km_mi,
    :agent_number,
    :warranty_sale_date,
    :plan_amount,
    :document_type,
    :identity_doc_no,
    :rg_no,
    :id_type,
    :document_issue_date,
    :document_agency,
    :quote_number,
    :quote_item_number,
    :new_used,
    :optional_coverage,
    :birth_date,
    :work_phone,
    :payment_type_code,
    :payment_instrument_code,
    :installments_number,
    :credit_card_type_code,
    :name_on_credit_card,
    :credit_card_number,
    :expiration_date,
    :bank_id,
    :account_number,
    :name_on_account,
    :layout,
    :branch_code,
    :created_by,
    :dealer_vsc_recon_wrk_id,
    :external_car_code,
    :PLAN_AMOUNT_WITH_MARKUP,
    :PAYMENT_DATE,
    :CANCELLATION_DATE,
    :CANCELLATION_REASON_CODE,
    :CANCEL_COMMENT_TYPE_CODE,
    :CANCELLATION_COMMENT,
    :financing_agency,
    :nc_payment_method_code,
    :account_type_code,
    :tax_id,
    :branch_digit,
    :account_digit,
    :refund_amount
    )
  </INSERT>
  <DELETE>
    DELETE FROM elp_dealer_vsc_recon_wrk
    WHERE
    dealer_vsc_recon_wrk_id = :dealer_vsc_recon_wrk_id
  </DELETE>
</SQL>